<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>√în t·∫≠p Gi·ªØa k√¨ I - To√°n 8</title>

<!-- UI cƒÉn b·∫£n, mobile-first -->
<style>
  :root{
    --bg:#f6f8fb;
    --card:#ffffff;
    --text:#1f2937;
    --muted:#6b7280;
    --brand:#2563eb;
    --brand-soft:#e6f0ff;
    --ok:#16a34a;
    --wrong:#dc2626;
    --hint:#eaf3ff;
    --chip:#f1f5f9;
    --border:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    background:var(--bg);
    color:var(--text);
  }
  .container{
    max-width: 1080px;
    margin: 0 auto;
    padding: 16px;
  }
  header{
    text-align:center;
    margin: 10px 0 16px;
  }
  h1{
    font-size: clamp(20px,4.2vw,34px);
    margin: 8px 0;
  }
  .subtitle{
    color:var(--muted);
    font-size: 14px;
  }
  .toolbar{
    display:flex;
    gap:8px;
    justify-content:center;
    flex-wrap:wrap;
    margin: 10px 0 18px;
  }
  button{
    border:1px solid var(--border);
    background:var(--card);
    color:var(--text);
    padding:10px 14px;
    border-radius:10px;
    cursor:pointer;
    font-weight:600;
  }
  button.primary{ background: var(--brand); color:#fff; border-color: transparent;}
  button.soft{ background: var(--brand-soft); color:#0b3abf; border-color:transparent;}
  button:active{ transform: translateY(1px); }

  .section-title{
    margin: 28px 0 10px;
    font-weight:800;
    font-size: clamp(18px,3.4vw,26px);
    text-align:center;
  }
  .note{
    text-align:center;
    color:var(--muted);
    font-size:13px;
    margin-bottom:8px;
  }

  .card{
    background:var(--card);
    border:1px solid var(--border);
    border-radius:14px;
    padding:14px;
    margin:10px 0 16px;
  }
  .q-header{
    font-weight:700;
    margin-bottom:10px;
    line-height:1.45;
  }
  .q-body{ margin-top:10px; }
  .q-img{
    max-width: 320px;
    max-height: 220px;
    width: auto;
    height: auto;
    display:block;
    margin:8px 0;
    border-radius:8px;
  }
  .opt{
    display:flex; align-items:flex-start; gap:10px;
    padding:10px 8px; border-radius:10px;
  }
  .opt:hover{ background:#fafafa; }
  .opt input{ margin-top:3px; transform:scale(1.12); }
  .opt label{ flex:1; cursor:pointer; }
  .hint-wrap{ margin-top:8px; }
  .hint-btn{
    background:#e0f2ff; color:#0b4a8f;
    border:none; padding:8px 12px; border-radius:8px; font-weight:700;
  }
  .hint-text{
    background:var(--hint);
    border-left: 3px solid var(--brand);
    padding:10px 12px;
    border-radius:10px;
    color:#0b3a79;
    margin-top:8px;
    display:none;
  }

  /* tag math */
  .math { font-family: "STIX Two Text","Times New Roman",serif; }
  .math sup { font-size: 0.74em; line-height: 0; vertical-align: baseline; }

  /* score bar */
  .score{
    font-size:13px; color:var(--muted); text-align:right;
  }

  /* multi10 grid */
  .grid{
    display:grid; gap:8px;
  }
  @media(min-width:700px){
    .grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
  }

  /* footer */
  footer{ text-align:center; color:var(--muted); font-size:12px; margin:16px 0 40px; }
</style>
</head>
<body>
  <div class="container">
    <header>
      <h1>√în t·∫≠p Gi·ªØa k√¨ I - To√°n 8</h1>
      <div class="subtitle">H·ªó tr·ª£ k√Ω hi·ªáu to√°n ƒë·∫πp (x¬≤, y¬≥, AÃÇ, //, ‚ä•), g·ª£i √Ω ki·∫øn th·ª©c, 2 n√∫t l√†m l·∫°i (gi·ªØ nguy√™n / x√°o tr·ªôn).</div>
      <div class="toolbar">
        <button class="soft" id="btnReset">üîÑ L√†m l·∫°i (kh√¥ng x√°o)</button>
        <button class="primary" id="btnShuffle">üé≤ L√†m l·∫°i + x√°o tr·ªôn</button>
      </div>
    </header>

    <div class="section-title">PH·∫¶N TR·∫ÆC NGHI·ªÜM</div>
    <div class="note">Ch·ªçn 1 ph∆∞∆°ng √°n ƒë√∫ng cho m·ªói c√¢u.</div>
    <div id="mcqList"></div>

    <div class="section-title">PH·∫¶N T·ª∞ LU·∫¨N</div>
    <div class="note">Ki·ªÉu A: ch·ªçn 10 √Ω/5 ƒë√∫ng (theo SGK *K·∫øt n·ªëi tri th·ª©c*). M·ªói b√†i c√≥ n√∫t g·ª£i √Ω.</div>
    <div id="multiList"></div>

    <footer>¬© l·ªõp To√°n 8 ‚Äì luy·ªán ƒë·ªÅ tr√™n GitHub Pages</footer>
  </div>

<script>
/* ====== ƒê·ªãnh d·∫°ng to√°n h·ªçc: ^ ‚Üí <sup>, A^ ‚Üí AÃÇ, perp ‚Üí ‚ä• ====== */
const supers = { "-":"‚Åª","0":"‚Å∞","1":"¬π","2":"¬≤","3":"¬≥","4":"‚Å¥","5":"‚Åµ","6":"‚Å∂","7":"‚Å∑","8":"‚Å∏","9":"‚Åπ" };
function toSup(s){ return String(s).split("").map(ch => supers[ch] ?? ch).join(""); }
function formatMath(text){
  if(!text) return text;
  // x^2 / y^-3
  text = text.replace(/([A-Za-z])\^(-?\d+)/g, (_,v,e) => `${v}<sup>${toSup(e)}</sup>`);
  // 10^2
  text = text.replace(/(\d)\^(-?\d+)/g, (_,d,e) => `${d}<sup>${toSup(e)}</sup>`);
  // (x+y)^3
  text = text.replace(/(\))\^(-?\d+)/g, (_,p,e) => `${p}<sup>${toSup(e)}</sup>`);
  // A^BC ‚Üí AÃÇBC
  text = text.replace(/([A-Z])\^/g, (_,L) => `${L}\u0302`);
  // perp ‚Üí ‚ä•
  text = text.replace(/\bperp\b/gi, "‚ä•");
  return text;
}
function setMath(el, raw){
  el.classList.add('math');
  el.innerHTML = formatMath(raw);
}

/* ====== Utils ====== */
const $ = (sel,root=document) => root.querySelector(sel);
const $$ = (sel,root=document) => [...root.querySelectorAll(sel)];
const shuffle = arr => arr.sort(()=>Math.random()-0.5);

/* ====== Data ====== */
let MCQS = [], MULTI10 = [];
let keepOrder = true; // reset ko x√°o

/* ====== Render MCQ ====== */
function renderMcqs(){
  const wrap = $('#mcqList'); wrap.innerHTML = '';
  const list = keepOrder ? [...MCQS] : shuffle([...MCQS]);

  list.forEach((q,idx)=>{
    const card = document.createElement('div');
    card.className = 'card';

    const head = document.createElement('div');
    head.className = 'q-header';
    setMath(head, `C√¢u ${idx+1}: ${q.stem}`);
    card.appendChild(head);

    if(q.img){
      const img = document.createElement('img');
      img.src = q.img; img.alt = 'minh ho·∫°'; img.className='q-img';
      card.appendChild(img);
    }

    const body = document.createElement('div'); body.className='q-body';
    const options = keepOrder ? [...q.options] : shuffle([...q.options]);

    options.forEach((opt, i)=>{
      const optIdx = q.options.indexOf(opt); // index theo b·∫£n g·ªëc ƒë·ªÉ so s√°nh answer
      const row = document.createElement('div'); row.className='opt';
      const ip = document.createElement('input');
      ip.type = 'radio'; ip.name = `mcq-${idx}`; ip.id = `mcq-${idx}-${i}`;
      const lb = document.createElement('label'); lb.setAttribute('for', ip.id);
      setMath(lb, String.fromCharCode(65+i)+'. '+opt);
      ip.addEventListener('change', ()=>{
        // highlight ƒë√∫ng/sai nh·∫π nh√†ng
        const all = $$( 'input[name="'+ip.name+'"]', card);
        all.forEach(x=>x.parentElement.style.background='transparent');
        row.style.background = '#f8fafc';
      });
      row.append(ip, lb);
      body.appendChild(row);

      // l∆∞u l·∫°i ƒë·ªÉ check ƒë√°p √°n khi c·∫ßn (·ªü ƒë√¢y ch·ªâ h·ªçc sinh t·ª± so)
      row.dataset.correct = (optIdx === q.answer) ? '1':'0';
    });

    // g·ª£i √Ω
    const hintWrap = document.createElement('div'); hintWrap.className='hint-wrap';
    const btn = document.createElement('button'); btn.className='hint-btn'; btn.textContent='G·ª£i √Ω';
    const hint = document.createElement('div'); hint.className='hint-text';
    setMath(hint, q.hint || '√în l·∫°i ƒë·ªãnh nghƒ©a/t√≠nh ch·∫•t li√™n quan trong SGK.');
    btn.addEventListener('click', ()=>{ hint.style.display = (hint.style.display==='block'?'none':'block'); });
    hintWrap.append(btn, hint);

    // ƒëi·ªÉm (t√πy ch·ªçn)
    // const score = document.createElement('div'); score.className='score'; score.textContent = ' ';
    card.append(body, hintWrap /*, score*/);
    wrap.appendChild(card);
  });
}

/* ====== Render Multi10 ====== */
function renderMulti10(){
  const wrap = $('#multiList'); wrap.innerHTML='';
  const list = keepOrder ? [...MULTI10] : shuffle([...MULTI10]);

  list.forEach((q, idx)=>{
    const card = document.createElement('div'); card.className='card';

    const head = document.createElement('div'); head.className='q-header';
    setMath(head, `C√¢u ${idx+1}A: ${q.title}`);
    card.appendChild(head);

    if(q.img){
      const img = document.createElement('img');
      img.src = q.img; img.alt='minh ho·∫°'; img.className='q-img';
      card.appendChild(img);
    }

    const grid = document.createElement('div'); grid.className='grid';
    // gi·ªØ th·ª© t·ª± m·∫∑c ƒë·ªãnh ƒë·ªÉ HS luy·ªán theo SGK; n·∫øu ƒëang ch·∫ø ƒë·ªô x√°o th√¨ x√°o:
    const items = keepOrder ? [...q.items] : shuffle([...q.items]);

    items.forEach((it, i)=>{
      const [text, truth] = it; // truth = 1 ƒë√∫ng, 0 sai
      const row = document.createElement('div'); row.className='opt';
      const ip = document.createElement('input');
      ip.type='checkbox'; ip.id=`m10-${idx}-${i}`;
      const lb = document.createElement('label'); lb.setAttribute('for', ip.id);
      setMath(lb, text);
      row.append(ip, lb);
      row.dataset.truth = truth ? '1':'0';
      grid.appendChild(row);
    });

    const hintWrap = document.createElement('div'); hintWrap.className='hint-wrap';
    const btn = document.createElement('button'); btn.className='hint-btn'; btn.textContent='G·ª£i √Ω';
    const hint = document.createElement('div'); hint.className='hint-text';
    setMath(hint, q.hint || '√în l·∫°i ƒë·ªãnh nghƒ©a/t√≠nh ch·∫•t trong SGK.');
    btn.addEventListener('click', ()=>{ hint.style.display = (hint.style.display==='block'?'none':'block'); });
    hintWrap.append(btn, hint);

    card.appendChild(grid);
    card.appendChild(hintWrap);
    wrap.appendChild(card);
  });
}

/* ====== Reset / Shuffle ====== */
$('#btnReset').addEventListener('click', ()=>{ keepOrder = true; renderMcqs(); renderMulti10(); window.scrollTo({top:0,behavior:'smooth'}); });
$('#btnShuffle').addEventListener('click', ()=>{ keepOrder = false; renderMcqs(); renderMulti10(); window.scrollTo({top:0,behavior:'smooth'}); });

/* ====== Load data ====== */
(async function init(){
  try{
    const res = await fetch('questions.json', {cache:'no-store'});
    const data = await res.json();
    MCQS = data.mcqs || [];
    MULTI10 = data.multi10 || [];
    renderMcqs();
    renderMulti10();
  }catch(e){
    console.error(e);
    alert('Kh√¥ng t·∫£i ƒë∆∞·ª£c questions.json. Ki·ªÉm tra l·∫°i repo nh√©.');
  }
})();
</script>
</body>
</html>
